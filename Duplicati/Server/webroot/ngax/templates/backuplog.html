<div ng-controller="BackupLogController" class="logpage">

    <h1 translate>Log data for <b>{{Backup.Backup.Name}}</b></h1>

    <ul class="tabs">
        <li ng-class="{active: Page=='general'}"><a href ng-click="Page='general'" translate>General</a></li>
        <li ng-class="{active: Page=='remote'}"><a href ng-click="Page='remote'" translate>Remote</a></li>
    </ul>

    <div ng-show="Page == 'general'">
        <ul class="entries backuplog">
            <li ng-show="GeneralData == null" translate>Loading ...</li>
            <li ng-repeat="item in GeneralData">
                <div ng-click="expanded = !expanded" class="entryline clickable">
                    <i ng-show="item.Result && item.Result.ParsedResult == 'Success'" class="fa fa-check-circle success-color"></i>
                    <i ng-show="item.Result && item.Result.ParsedResult == 'Warning'" class="fa fa-exclamation-circle warning-color"></i>
                    <i ng-show="item.Result && item.Result.ParsedResult == 'Error'" class="fa fa-times-circle error-color"></i>
                    {{item.Timestamp | parsetimestamp}} - {{"Operation" | translate}}: {{item.Result ? item.Result.MainOperation : item.Type | translate}}
                </div>
                <div ng-show="expanded && item.Result" class="backup-result">
                    <div class="one">
                        <span class="title">Time</span>
                        <span class="item">
                            <span class="key">{{ "Start" | translate }} </span>
                            <span class="value">{{ parseTimestampToSeconds(item.Result.BeginTime) }}</span>
                        </span>
                        <span class="item">
                            <span class="key">{{ "End" | translate }} </span>
                            <span class="value">{{ parseTimestampToSeconds(item.Result.EndTime) }}</span>
                        </span>
                        <span class="item">
                            <span class="key">{{ "Duration" | translate }} </span>
                            <span class="value">{{ formatDuration(item.Result.Duration) }}</span>
                        </span>
                    </div>
                    <div class="two"> 
                        <span class="title">Files</span>
                        <span class="item">
                            <span class="key">{{ "Examined" | translate }} </span>
                            <span class="value">{{ item.Result.ExaminedFiles }} ({{ formatSize(item.Result.SizeOfExaminedFiles) }})</span>
                        </span>
                        <span class="item">
                            <span class="key">{{ "Opened" | translate }} </span>
                            <span class="value">{{ item.Result.OpenedFiles }} ({{ formatSize(item.Result.SizeOfOpenedFiles) }})</span>
                        </span>
                        <span class="item">
                            <span class="key">{{ "Added" | translate }} </span>
                            <span class="value">{{ item.Result.AddedFiles }} ({{ formatSize(item.Result.SizeOfAddedFiles) }})</span>
                        </span>
                        <span class="item">
                            <span class="key">{{ "Modified" | translate }} </span>
                            <span class="value">{{ item.Result.ModifiedFiles }} ({{ formatSize(item.Result.SizeOfModifiedFiles) }})</span>
                        </span>
                        <span class="item">
                            <span class="key">{{ "Deleted" | translate }} </span>
                            <span class="value">{{ item.Result.DeletedFiles }} ({{ formatSize(item.Result.SizeOfDeletedFiles) }})</span>
                        </span>
                    </div>
                    <div class="wide three">
                            <span class="item">
                                <span class="key">{{ "Warnings" | translate }} </span>
                                <span class="value" ng-click="w_expanded = !w_expanded" ng-style="{ cursor: (item.Result.Warnings.length > 0) ? 'pointer' : '' }">
                                    {{ item.Result.Warnings.length }} {{item.Result.Warnings.length > 0 ? (w_expanded ? "▼" : "►") : ""}}
                                </span>
                                <div ng-show="w_expanded" style="margin: 10px;">
                                    <ul>
                                        <li ng-repeat="warning in item.Result.Warnings">{{warning}}</li>
                                    </ul>
                                </div>
                            </span>
                            <span class="item">
                                <span class="key">{{ "Errors" | translate }} </span>
                                <span class="value" ng-click="e_expanded = !e_expanded" ng-style="{ cursor: (item.Result.Errors.length > 0) ? 'pointer' : '' }">
                                    {{ item.Result.Errors.length }} {{item.Result.Errors.length > 0 ? (e_expanded ? "▼" : "►") : ""}}
                                </span>
                                <div ng-show="e_expanded" style="margin: 10px;">
                                    <ul>
                                        <li ng-repeat="warning in item.Result.Warnings">{{warning}}</li>
                                    </ul>
                                </div>
                            </span>  
                    </div>
                    <div class="item wide four">
                        <span class="key">{{ "Complete log" | translate }}</span>
                        <div class="prewrapped-text exceptiontext">{{ item.Formatted }}</div>
                    </div>
                </div>
                <div ng-show="expanded && !item.Result" class="prewrapped-text exceptiontext">{{item.Message}}</div>
            </li>
        </ul>
        <div ng-show="GeneralData != null &amp;&amp; !GeneralDataComplete" class="button" ng-click="LoadMoreGeneralData()">
            <span ng-show="LoadingData" translate>Loading ...</span>
            <span ng-hide="LoadingData" translate>Load older data</span>
        </div>
    </div>

    <div ng-show="Page == 'remote'">
        <ul class="entries">
            <li ng-show="RemoteData == null" translate>Loading ...</li>
            <li ng-repeat="item in RemoteData">
                <div ng-click="expanded = !expanded" class="entryline clickable">{{item.Timestamp | parsetimestamp}}: {{item.Operation}} {{item.Path}}</div>
                <div ng-show="expanded" class="prewrapped-text exceptiontext">{{item.Data}}</div>
            </li>
        </ul>
        <div ng-show="RemoteData != null &amp;&amp; !RemoteDataComplete" class="button" ng-click="LoadMoreRemoteData()">
            <span ng-show="LoadingData" translate>Loading ...</span>
            <span ng-hide="LoadingData" translate>Load older data</span>
        </div>
    </div>
</div>
